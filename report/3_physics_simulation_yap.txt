The physics simulation was originally written as a combination of a physics and rendering engine, using pure python for the physics, and the Pygame library for the UI element. This was for ease of initial implementation, and was always planned to be separated into two components later. At first, one world unit and one pixel were not only the same size but were the same thing.
The physics simulation was also in charge of spawning obstacles for the AI to avoid, utilising a random algoritm to ensure that the AI did not learn any patterns to avoid the obstacles instead of learning to avoid them properly. The random algorithm used is a Mersenne Twister, which is included in the Python standard library. These obstacles were infinitely generating, with ones that fell off of the screen moving themselves to become effectively new obstacles. This then meant that the simulation could run theoretically indefinitely assuming the vehicle did not crash. Initially the difficulty stayed constant, but this was later changed so that the difficulty of the simulation increased over time.
As well as the obstacles being spawned, there was also a "floor is lava" condition added to the simulation, so that any vehicle not making good progress, for example one that is spinning in circles, would still eventually have its run ended. This worked by having the "lava" start at some point behind the car, and gradually move in the same direction as the car was moving, eventually catching up with any car  not making progress. The speed however, was extremely slow, in order to give vehicles the ability to move backwards if necessary, without having their run ended immediately.
The separation of the physics from the rendering was fairly simple, with the physics easily able to be pulled out into its own class and associated member functions This allowed not only separation from the UI element of the progam, but also for more than one physics instance to be run at the same time. This was intended to allow for easier training of the AI once it had been implemented.
In order to further achieve the running of multiple simulations at once, it was made so that it must be constantly ticked in order to progress. This way, the program will simply run the simulations as fast as it can, whilst also keeping them in sync, instead of potentially having some simulations run out of sync with others.
Bringing the UI into its own class was also a fairly simple task. This was less of a requirement and more because the physics was already being pulled into its own class, but it did enable us to rewrite the UI to use Pyglet instead of Pygame much easier.
The main motivation for moving to Pyglet over Pygame was the ability to have more than one window open at a time, with the intention of being able to see overview information in one window, and an example of an AI currently being simulated in another window.
